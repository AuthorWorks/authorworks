# AuthorWorks Traefik IngressRoute
# Uses Traefik CRD for routing - Cloudflare handles SSL termination
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: authorworks
  namespace: authorworks
  labels:
    app: authorworks
    environment: homelab
spec:
  entryPoints:
    - web
  routes:
    # API routes - proxy to backend services
    - kind: Rule
      match: Host(`author.works`) && PathPrefix(`/api`)
      services:
        - name: authorworks-platform
          port: 80
    # Frontend - Next.js application
    - kind: Rule
      match: Host(`author.works`) || Host(`www.author.works`)
      services:
        - name: authorworks-frontend
          port: 3000
---
# API subdomain route
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: authorworks-api
  namespace: authorworks
  labels:
    app: authorworks
    environment: homelab
spec:
  entryPoints:
    - web
  routes:
    - kind: Rule
      match: Host(`api.author.works`)
      services:
        - name: authorworks-platform
          port: 80
